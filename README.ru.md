# Сканер Modbus TCP

Мощный инструмент на Python для сканирования устройств шины RS-485 через шлюзы Modbus TCP.

## Обзор

Этот скрипт предоставляет улучшенный метод обнаружения и идентификации Modbus-устройств, подключенных к шине RS-485 через шлюз Modbus TCP. Он реализует оптимизированные стратегии сканирования и комплексные методы опроса устройств для максимального увеличения шансов обнаружения всех подключенных устройств.

## Возможности

- Совместимость с версиями pymodbus 2.x и 3.x
- Оптимизированная стратегия сканирования (с приоритетом часто используемых адресов)
- Множественные попытки подключения с обработкой ошибок
- Расширенная проверка регистров с использованием различных функций Modbus:
  - Чтение регистров хранения (функция 3)
  - Чтение входных регистров (функция 4)
  - Чтение дискретных выходов (функция 1)
  - Чтение дискретных входов (функция 2)
- Подробный отчет об обнаруженных устройствах и их возможностях
- Практические рекомендации по устранению неполадок, если устройства не обнаружены

## Требования

- Python 3.x
- Библиотека pymodbus (работает с версиями 2.x и 3.x)

## Установка

1. Убедитесь, что установлен Python 3.x
2. Установите необходимые зависимости:

```bash
pip install pymodbus
```

## Настройка

Отредактируйте следующие параметры в начале скрипта в соответствии с вашей системой:

```python
# Настройки подключения
GATEWAY_IP = "192.168.1.58"  # Измените на IP-адрес вашего шлюза
GATEWAY_PORT = 502           # Стандартный порт Modbus TCP
TIMEOUT = 2                  # Таймаут в секундах

# Диапазон сканирования
START_ADDRESS = 1
END_ADDRESS = 247            # Полный диапазон адресов Modbus

# Известные адреса для проверки в первую очередь
KNOWN_ADDRESSES = [16, 1, 2, 3, 8, 10, 20, 32, 64, 100, 127, 200, 240]
```

## Использование

Просто запустите скрипт:

```bash
python modbustcp-scanner-ru.py
```

Скрипт выполнит следующие действия:
1. Подключится к указанному шлюзу Modbus TCP
2. Просканирует все адреса в оптимизированном порядке
3. Сообщит о любых обнаруженных устройствах с их поддерживаемыми функциями и данными регистров
4. Предоставит рекомендации по устранению неполадок, если устройства не будут обнаружены

## Устранение неполадок

Если устройства не обнаружены, скрипт предлагает следующие действия:

1. Проверьте физическое подключение устройств к шлюзу (кабели, питание)
2. Проверьте настройки порта на шлюзе (скорость передачи данных, четность, стоп-биты)
3. Убедитесь, что устройства настроены с поддерживаемыми параметрами связи
4. Протестируйте шлюз с помощью другого программного обеспечения (например, Modbus Poll)
5. Рассмотрите возможность установки терминаторов на концах линии RS-485

## Расширенное использование

Вы можете настроить скрипт для ваших конкретных потребностей:

- Изменив список `REGISTERS_TO_CHECK` для проверки конкретных регистров
- Добавив известные адреса устройств в список `KNOWN_ADDRESSES` для более быстрого обнаружения
- Настроив значение таймаута для более медленных сетей или устройств

## Лицензия

Этот проект предоставляется "как есть", свободен для использования и модификации.

## Вклад в проект

Приветствуются вклады, сообщения об ошибках и запросы на добавление новых функций!
